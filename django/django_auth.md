### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ Django
* –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –º–æ–¥–µ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ¬´–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é¬ª
```
–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –º–æ–¥–µ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ¬´–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é¬ª
1. –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å—á–∏—Ç–∞–µ—Ç—Å—è —Ä–µ–≥–∏—Å—Ç—Ä–æ–∑–∞–≤–∏—Å–∏–º—ã–º. –¢–æ –µ—Å—Ç—å, —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è Django, –∏–º–µ–Ω–∞, —Ç–∏–ø–∞
John –∏ john, —Ä–∞–∑–Ω—ã–µ.
2. –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–∞—Å—Ç–æ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ unicode-—Å–∏–º–≤–æ–ª–æ–≤. –ù–∞–ø—Ä–∏–º–µ—Ä, –≤ –Ω–µ–≥–æ –≤—Ö–æ–¥—è—Ç —Ç–∞–∫–∏–µ
—Å–∏–º–≤–æ–ª—ã, –∫–∞–∫ @, +, _ –∏ –¥–∞–∂–µüòé.
3. –ê–¥—Ä–µ—Å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã –Ω–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å
–æ–¥–Ω–∏–º –º–µ–π–ª–æ–º —Å–º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∞–∫–∫–∞—É–Ω—Ç–æ–≤. –ò –µ—Å–ª–∏ –≤ –æ–¥–Ω–æ–π —É—á—ë—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ –µ—Å—Ç—å
—á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, —Ç–æ –ø–æ—Ç–æ–º –±—É–¥–µ—Ç —Å–ª–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞—Ä–æ–ª—å —á–µ—Ä–µ–∑ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É—é
–ø–æ—á—Ç—É.
4. –ü–æ–ª–µ –∞–¥—Ä–µ—Å–∞ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã –∑–∞–ø–æ–ª–Ω—è—Ç—å –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ. –û–¥–Ω–∞–∫–æ –±–µ–∑ —ç—Ç–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
—Å–ª–æ–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫—Ç–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª—Å—è –Ω–∞ —Å–∞–π—Ç–µ: –±–æ—Ç –∏–ª–∏ —á–µ–ª–æ–≤–µ–∫.
5. –ò–Ω–æ–≥–¥–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –º–µ—Ç–æ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–∞—Ä–æ–ª—è –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä None.
–ò–∑-–∑–∞ —ç—Ç–æ–≥–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
6. –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –º–æ–¥–µ–ª–∏ ¬´–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é¬ª —Ç—Ä—É–¥–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –Ω–æ–≤—É—é –º–æ–¥–µ–ª—å
–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ–≥–¥–∞ –ø—Ä–æ–≤–æ–¥—è—Ç—Å—è –ø–µ—Ä–≤—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏.
–í–∞–∂–Ω–æ! –ù–µ–ª—å–∑—è –∑–∞–¥–∞—Ç—å –∞–≤–∞—Ç–∞—Ä –∏–ª–∏ –≤–æ–∑—Ä–∞—Å—Ç –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
–î–ª—è —Ä–µ—à–µ–Ω–∏—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —ç—Ç–∏—Ö –ø—Ä–æ–±–ª–µ–º —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ Django —Ä–µ–∫–æ–º–µ–Ω–¥—É—é—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é
—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –º–æ–¥–µ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
```
* —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```
python manage.py startapp authapp
```
* config/settings.py
```python
INSTALLED_APPS = [
    "django.contrib.admin",
    "django.contrib.auth",
    "django.contrib.contenttypes",
    "django.contrib.sessions",
    "django.contrib.messages",
    "django.contrib.staticfiles",
    "mainapp",
    "authapp", #new
]
```
* authapp/models.py –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –º–æ–¥–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```python
from pathlib import Path
from time import time

from django.contrib.auth.base_user import AbstractBaseUser
from django.contrib.auth.models import PermissionsMixin, UserManager
from django.contrib.auth.validators import ASCIIUsernameValidator
from django.core.mail import send_mail
from django.db import models
#—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –ø–µ—Ä–µ–≤–æ–¥–∞
from django.utils.translation import gettext_lazy as _

# —Ñ—É–Ω–∫—Ü–∏—è –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –∏ –∏–º—è —Ñ–∞–π–ª–∞ –∞–≤–∞—Ç–∞—Ä–∫–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ –≤–µ—Ä–º–µ–Ω–∏ –≤ —é–Ω–∏–∫–æ–¥
# instance ‚Äî —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ –º–æ–¥–µ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
# filename ‚Äî –∏–º—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
# —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞ pic_1702039183
def users_avatars_path(instance, filename):
    # —Ñ–∞–π–ª –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –≤:
    # MEDIA_ROOT / user_<username> / avatars / <filename>
    num = int(time() * 1000)
    suff = Path(filename).suffix
    return "user_{0}/avatars/{1}".format(instance.username, f"pic_{num}{suff}")


class CustomUser(AbstractBaseUser, PermissionsMixin):
    username_validator = ASCIIUsernameValidator()

    username = models.CharField(
        _("username"),
        max_length=150,
        unique=True,
        help_text=_("Required. 150 characters or fewer. Letters, digits and @/./+/-/_ only."),
        #–ø—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ —Å–∏–º–≤–æ–ª—ã -*/!@#$%^&*() –∏ —Ç.–¥.
        validators=[username_validator],
        error_messages={
            "unique": _("A user with that username already exists."),
        },
    )
    first_name = models.CharField(_("first name"), max_length=150, blank=True)
    last_name = models.CharField(_("last name"), max_length=150, blank=True)
    #—ç—Ç–æ–≥–æ –ø–æ–ª—è –Ω–∞–ø—Ä–∏–º–µ—Ä –Ω–µ—Ç –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –º–æ–¥–µ–ª–∏
    age = models.PositiveIntegerField(blank=True, null=True)
    # –ø–æ–ª–µ –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∫–∏
    avatar = models.ImageField(upload_to=users_avatars_path, blank=True, null=True)
    email = models.CharField(
        _("email address"),
        max_length=256,
        unique=True,
        error_messages={
            "unique": _("A user with that email address already exists."),
        },
    )
    is_staff = models.BooleanField(
        _("staff status"),
        default=False,
        help_text=_("Designates whether the user can log into this admin site."),
    )
    is_active = models.BooleanField(
        _("active"),
        default=True,
        help_text=_(
            "Designates whether this user should be treated as active. \
            Unselect this instead of deleting accounts."
        ),
    )
    date_joined = models.DateTimeField(_("date joined"), auto_now_add=True)

    #—Å—Ç–∞–Ω–¥–∞—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –º–æ–¥–µ–ª–∏, –¥–ª—è –º–æ–¥–µ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    objects = UserManager()

    EMAIL_FIELD = "email"
    USERNAME_FIELD = "username"
    REQUIRED_FIELDS = ["email"]

    #–∫–∞–∫ –º—ã –±—É–¥–µ–º –≤–∏–¥–µ—Ç—å –ø–æ–ª—è –≤ –∞–¥–º–∏–Ω–∫–µ
    class Meta:
        verbose_name = _("user")
        verbose_name_plural = _("users")

    # –º–µ—Ç–æ–¥ –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ e-mail
    def clean(self):
        super().clean()
        self.email = self.__class__.objects.normalize_email(self.email)

    # –ø–æ–ª–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–º—è, —Ñ–∞–º–∏–ª–∏—è —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª
    def get_full_name(self):
        """
        Return the first_name plus the last_name, with a space in between.
        """
        full_name = "%s %s" % (self.first_name, self.last_name)
        return full_name.strip()

    # —Ç–æ–ª—å–∫–æ –∏–º—è
    def get_short_name(self):
        """Return the short name for the user."""
        return self.first_name

    # –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø–∏—Å—å–º–æ –ø–æ e-mail
    def email_user(self, subject, message, from_email=None, **kwargs):
        """Send an email to this user."""
        send_mail(subject, message, from_email, [self.email], **kwargs)
```
* —á—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å
```
1. –í–∞–ª–∏–¥–∞—Ç–æ—Ä –¥–ª—è –ø–æ–ª—è username. –í–∞–ª–∏–¥–∞—Ç–æ—Ä—ã ‚Äî —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
–ø–æ–ª—è –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –∑–∞–ø–∏—Å–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ –ë–î. –¢–µ–ø–µ—Ä—å –ø–æ–ª–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ ASCII-—Å–∏–º–≤–æ–ª—ã.
2. –î–æ–±–∞–≤–∏–ª–æ—Å—å –ø–æ–ª–µ –≤–æ–∑—Ä–∞—Å—Ç–∞ ‚Äî age.
3. –ü–æ–ª–µ email —Ç–µ–ø–µ—Ä—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ.
4. –¢–µ–ø–µ—Ä—å –µ—Å—Ç—å –ø–æ–ª–µ avatar –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
```
* —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Pillow –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ (–∞–≤–∞—Ç–∞—Ä–∫–∏)
```
pip install Pillow
```
* config/settings.py –ø—Ä–æ–ø–∏—Å—ã–≤–∞–µ–º –ø—É—Ç—å –¥–æ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤
```python
MEDIA_URL = "/media/"
MEDIA_ROOT = BASE_DIR / "media"
```
* —Å–æ–∑–¥–∞–¥–∏–º –¥–∏—Å–ø–µ—Ç—á–µ—Ä—ã –∞–¥—Ä–µ—Å–æ–≤ (–∫–æ—Ä–Ω–µ–≤–æ–π –∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏)
* –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –º–µ–¥–∏–∞—Ñ–∞–π–ª–∞–º–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ—Ç–ª–∞–¥–∫–∏ –Ω–∞–¥–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —É–∫–∞–∑–∞—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ
–∞–¥—Ä–µ—Å–∞ –≤ –∫–æ—Ä–Ω–µ–≤–æ–º –¥–∏—Å–ø–µ—Ç—á–µ—Ä–µ config/urls.py
```python
from django.conf import settings
from django.conf.urls.static import static
from django.contrib import admin
from django.urls import include, path
from django.views.generic import RedirectView


urlpatterns = [
    path("admin/", admin.site.urls),
    path("", RedirectView.as_view(url="mainapp/")),
    path("mainapp/", include("mainapp.urls", namespace="mainapp")),
    path("authapp/", include("authapp.urls", namespace="authapp")),
]
if settings.DEBUG:
    urlpatterns += static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)
```
* authapp/urls.py
```python
from django.urls import path
from authapp import views
from authapp.apps import AuthappConfig


app_name = AuthappConfig.name

urlpatterns = [
    path("login/", views.CustomLoginView.as_view(), name="login"),
    path("logout/", views.CustomLogoutView.as_view(), name="logout"),
    path("register/", views.RegisterView.as_view(), name="register"),
    path("profile_edit/", views.ProfileEditView.as_view(), name="profile_edit"),
]
```
* config/settings.py –º–µ–Ω—è–µ–º –≤ –Ω–∞–π—Ç—Ä–æ–π–∫–∞—Ö —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –º–æ–¥–µ–ª—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```python
AUTH_USER_MODEL = "authapp.CustomUser"
```
* config/settings.py –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏ –≤—Ö–æ–¥–µ –∏ –≤—ã—Ö–æ–¥–µ
```python
LOGIN_REDIRECT_URL = "mainapp:main_page"
LOGOUT_REDIRECT_URL = "mainapp:main_page"
```
* config/settings.py –¥–∞–±–∞–≤–ª—è–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –¥–ª—è –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤
```python
TEMPLATES = [
    {
        "BACKEND": "django.template.backends.django.DjangoTemplates",
        "DIRS": [
            "templates",
        ],
        "APP_DIRS": True,
        "OPTIONS": {
            "context_processors": [
                "django.template.context_processors.debug",
                "django.template.context_processors.request",
                "django.template.context_processors.media", #new
                "django.contrib.auth.context_processors.auth",
                "mainapp.context_processors.example.simple_context_processor",
            ],
        },
    },
]
```
### –§—Ä–µ–π–º–≤–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π
```
–í Django ¬´–∏–∑ –∫–æ—Ä–æ–±–∫–∏¬ª –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ —Å–æ–æ–±—â–µ–Ω–∏–π. –≠—Ç–æ—Ç –º–µ—Ö–∞–Ω–∏–∑–º –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–≤–æ–¥–∏—Ç—å
–¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ä–∞–∑–ª–∏—á–Ω—É—é —Å–ª—É–∂–µ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ –≤–∏–¥–µ –≤—Å–ø–ª—ã–≤–∞—é—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π.
–≠—Ç–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –≤ –º–æ–º–µ–Ω—Ç —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è
–æ—Ç–≤–µ—Ç–∞ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞. –¢—Ä–µ–±—É–µ–º—ã–π –≤—Ö–æ–¥–Ω–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä ‚Äî –æ–±—ä–µ–∫—Ç –∑–∞–ø—Ä–æ—Å–∞.
–°–æ–æ–±—â–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è:

‚óè–≤ —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è;
‚óècookies;
‚óè—Å–≤–æ–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞.

–°–æ–æ–±—â–µ–Ω–∏—è —Ç–∞–∫–∂–µ —Ä–∞–∑–¥–µ–ª—è—é—Ç—Å—è –ø–æ —É—Ä–æ–≤–Ω—é –≤–∞–∂–Ω–æ—Å—Ç–∏: debug, info, success, warning, error. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç, –Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç—Å–µ–∫–∞—Ç—å –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ (debug) —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –ø—Ä–æ–¥—É–∫—Ç–æ–≤–æ–π —Å—Ä–µ–¥–µ. –°–æ–æ–±—â–µ–Ω–∏—è —É–¥–æ–±–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏ –æ—Ç–ª–∞–¥–∫–µ, –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π –∏ —Ç. –¥. –°–æ—á–µ—Ç–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —à–∞–±–ª–æ–Ω–æ–≤ Django –∏ JavaScript, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤—ã–≤–æ–¥—è—Ç—Å—è –∏ –≤ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞. –û–¥–Ω–∞–∫–æ –Ω–µ —Å—Ç–æ–∏—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª—è—Ç—å —ç—Ç–∏–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º: —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Ä–∞–∑–¥—Ä–∞–∂–∞—é—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
–í –∫–∞—á–µ—Å—Ç–≤–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–µ—Å—Å–∏–∏.
```
* config/settings.py
```python
MESSAGE_STORAGE = "django.contrib.messages.storage.session.SessionStorage"
```
* config/settings.py
```python
TEMPLATES = [
    {
        "BACKEND": "django.template.backends.django.DjangoTemplates",
        "DIRS": [
            "templates",
        ],
        "APP_DIRS": True,
        "OPTIONS": {
            "context_processors": [
                "django.template.context_processors.debug",
                "django.template.context_processors.request",
                "django.template.context_processors.media",
                "django.contrib.auth.context_processors.auth",
                "django.contrib.messages.context_processors.messages", #new
                "mainapp.context_processors.example.simple_context_processor",
            ],
        },
    },
]
```
* authapp/views.py –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤—Ö–æ–¥–∞ —Å –≤—ã–≤–æ–¥–æ–º —Å–æ–æ—â–±–µ–Ω–∏–π
```python
from django.contrib import messages
from django.contrib.auth.views import LoginView
from django.utils.safestring import mark_safe
#—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –ø–µ—Ä–µ–≤–æ–¥–∞ –Ω–∞ –¥—Ä—É–≥–æ–π —è–∑—ã–∫
from django.utils.translation import gettext_lazy as _


class CustomLoginView(LoginView):
    def form_valid(self, form):
        ret = super().form_valid(form)
        #–∫–æ–¥ –¥–ª—è –≤—ã–≤–æ–¥–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
        message = _("Login success!<br>Hi, %(username)s") % {
            "username": self.request.user.get_full_name()
            if self.request.user.get_full_name()
            else self.request.user.get_username()
        }
        messages.add_message(self.request, messages.INFO, mark_safe(message))
        return ret

    def form_invalid(self, form):
        #–∫–æ–¥ –¥–ª—è –≤—ã–≤–æ–¥–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
        for _unused, msg in form.error_messages.items():
            messages.add_message(
                self.request,
                messages.WARNING,
                mark_safe(f"Something goes worng:<br>{msg}"),
            )
        return self.render_to_response(self.get_context_data(form=form))
```
* —Å–æ–∑–¥–∞–µ–º –ø–∞–ø–∫—É –¥–ª—è —à–∞–±–ª–æ–Ω–æ–≤
```
mkdir -p authapp/templates/registration/
```
* –ø–µ—Ä–µ–Ω–æ—Å–∏–º –≤ –Ω–µ–µ —Ñ–∞–π–ª login.html
```
mv ./mainapp/templates/mainapp/login.html ./authapp/templates/registration/
```
* authapp/templates/registration/login.html —Å –≤—Å–ø–ª—ã–≤–∞—é—â–∏–º–∏ –æ–∫–Ω–∞–º–∏
```html
{% extends 'base.html' %}
{% load static %}
{% block content %}

    {% include 'includes/messages.html' %}

    <div class="row justify-content-around align-items-center" style="height: 100vh; margin: 0px">
        <div class="text-center">
            <p>
                <a href="{% url 'mainapp:main_page' %}"><img src="{% static 'img/logo.png' %}" alt=""></a>
            </p>
            <h2>–í—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h2>
            <form method="POST">

                {% csrf_token %}
                <p>
                    <input type="text" name="username" autofocus="" autocapitalize="none" autocomplete="username"
                        maxlength="150" class="textinput textInput form-control" required="" id="id_username"
                        placeholder="Username">
                </p>
                <p>
                    <input type="password" name="password" autocomplete="current-password"
                        class="textinput textInput form-control" required="" id="id_password" placeholder="Password">
                </p>
                <p>
                    <button type="submit" class="btn btn-primary btn-block">–í–æ–π—Ç–∏</button>
                </p>
            </form>
            <p>
            <div class="row justify-content-between">
                <div class="col">
                    <a href="{% url 'authapp:register' %}"><small>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</small></a>
                </div>
                <div class="col">
                    <a href="#"><small>–ó–∞–±—ã–ª–∏ –ø–∞—Ä–æ–ª—å?</small></a>
                </div>
            </div>
            </p>
            <h4>–í—Ö–æ–¥ —á–µ—Ä–µ–∑ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏</h4>
            <p>
            <div class="btn-group btn-block" role="group">
                <a class="btn btn-primary" href="#" role="button"><i class="fab fa-vk"></i></a>
                <a class="btn btn-primary" href="#" role="button"><i class="fab fa-github"></i></a>
                <a class="btn btn-primary" href="#" role="button"><i class="fab fa-facebook"></i></a>
            </div>
            </p>
        </div>
    </div>

{% endblock content %}
```
* –∫–æ–¥ —Å–∞–º–∏—Ö –≤—Å–ø–ª—ã–≤–∞—é—â–∏–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
```
touch templates/includes/messages.html
```
```html
<div class="position-absolute w-100" style="z-index: 1;">
    <div aria-live="polite" aria-atomic="true" class="m-2">
      <!-- Position it -->
      <div class="d-flex align-items-end flex-column">

        {% for message in messages %}
        <!-- Then put toasts within -->
        <div class="toast flex-fill w-100
      {% if message.level == 30 %}
      border-warning
      {% endif %}
        " role="alert" aria-live="assertive" aria-atomic="true"
          style="right: 0;">
          <div class="toast-header">
            <span class="mr-2"><i class="far fa-envelope"></i></span>
            <strong
              class="mr-auto {% if message.level == 30 %}text-warning{% endif %}">
              {{ message.tags|capfirst }} message</strong>
            <small class="text-muted">just now</small>
            <button type="button" class="ml-2 mb-1 close" data-dismiss="toast"
              aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="toast-body">
            {{ message }}
          </div>
        </div>
        {% if message.level > 20 %}
        <!-- If message will dissapere you will find message in console -->
        <script>
          console.log("{{ message }}");
        </script>
        {% endif %}

        {% endfor %}

      </div>
    </div>
  </div>
```
* mainapp/templates/mainapp/base.html –¥–æ–±–∞–≤–ª—è–µ–º –±–ª–æ–∫ {% block js %} –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
```html
{% load static %}

<!doctype html>
<html lang="ru">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport"
    content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">

  <!-- ChartJS -->
  <link rel="stylesheet" href="{% static 'css/Chart.min.css' %}">

  <!-- FontAwesome -->
  <link rel="stylesheet" href="{% static 'css/fontawesome.all.min.css' %}">

  <title>
    {% block title %}
    Welcome to Braniac!
    {% endblock title %}
  </title>
</head>

<body>

  {% include 'includes/main_menu.html' %}

  {% block messages %}
  {% include 'includes/messages.html' %}
  {% endblock messages %}

  <div class="container-md">

    {% block content %}{% endblock content %}

  </div>

  <!-- Footer -->

  <div class="container-lg mt-auto">
    <hr>
    <div class="row justify-content-center">
      <div class="col-sm-6 col-md-3 text-center">
        <p>
          <strong>Braniac</strong>
        </p>
        <p>
        <ul class="list-unstyled">
          <li><a href="{% url 'mainapp:main_page' %}">–î–æ–º–∞—à–Ω—è—è</a></li>
          <li><a href="{% url 'mainapp:news' %}">–ù–æ–≤–æ—Å—Ç–∏</a></li>
          {% if user.is_authenticated %}
          <li><a href="{% url 'authapp:logout' %}">–í—ã–π—Ç–∏</a></li>
          {% else %}
          <li><a href="{% url 'authapp:login' %}">–í–æ–π—Ç–∏</a></li>
          {% endif %}
        </ul>
        </p>
      </div>
      <div class="col-sm-6 col-md-3 text-center">
        <p>
          <strong>–ü–æ–ª–µ–∑–Ω–æ–µ</strong>
        </p>
        <p>
        <ul class="list-unstyled">
          <li><a href="#">–ü–æ–ª–æ–∂–µ–Ω–∏—è &amp; –£—Å–ª–æ–≤–∏—è</a></li>
          <li><a href="#">–ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å &amp; Cookies</a></li>
          <li><a href="#">–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ API</a></li>
          <li><a href="{% url 'mainapp:doc_site' %}">–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Å–∞–π—Ç—É</a>
          </li>
        </ul>
        </p>
      </div>
      <div class="col-sm-6 col-md-3 text-center">
        <p>
          <strong>–ú—ã –≤ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç—è—Ö</strong>
        </p>
        <p>
        <div class="row justify-content-around">
          <div><a href="#"><i class="fab fa-vk fa-2x"></i></a></div>
          <div><a href="#"><i class="fab fa-facebook-f fa-2x"></i></a>
          </div>
          <div><a href="#"><i class="fab fa-instagram fa-2x"></i></a>
          </div>
          <div><a href="#"><i class="fab fa-pinterest-p fa-2x"></i></a></div>
        </div>
        </p>
        <p>
          <strong>–ù–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</strong>
        </p>
        <p>
        <div class="row justify-content-around">
          <div><a href="#"><i class="fab fa-app-store fa-2x"></i></a>
          </div>
          <div><a href="#"><i class="fab fa-google-play fa-2x"></i></a></div>
          <div><a href="#"><i class="fab fa-windows fa-2x"></i></a>
          </div>
        </div>
        </p>
      </div>
    </div>
    <div class="row justify-content-center">
      <div>
        <p><small>&copy; GeekBrains 2021</small></p>
      </div>
    </div>
  </div>

  <!-- /Footer -->

  <!-- JavaScript section -->
  <!-- Bootstrap -->
  <script src="{% static 'js/jquery-3.6.0.min.js' %}"></script>
  <script src="{% static 'js/popper.min.js' %}"></script>
  <script src="{% static 'js/bootstrap.min.js' %}"></script>

  <!-- ChartJs -->
  <script src="{% static 'js/Chart.min.js' %}"></script>

  <!-- FontAwesome -->
  <script src="{% static 'js/fontawesome.all.min.js' %}"></script>

  {% block js %}
  <script>
    $(document).ready(function () {

      {% if messages %}
      // Toasts
      $(".toast").toast({ delay: 5000 });
      $(".toast").toast("show");
      {% endif %}

    });
  </script>
  {% endblock js %}

</body>

</html>
```
* —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≤—ã—Ö–æ–¥–∞
* –ü—Ä–∏ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –ø–æ –∞–¥—Ä–µ—Å—É, —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π LOGOUT_REDIRECT_URL
* authapp/views.py –¥–æ–±–∞–≤–ª—è–µ–º –≤–Ω–∏–∑ —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥
```python
class CustomLogoutView(LogoutView):
    def dispatch(self, request, *args, **kwargs):
        messages.add_message(self.request, messages.INFO, _("See you later!"))
        return super().dispatch(request, *args, **kwargs)
```
* —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
* —Å–≤–æ–π—Å—Ç–≤–æ enctype="multipart/form-data", –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ñ–∞–π–ª—ã –∫–∞—Ä—Ç–∏–Ω–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
```
touch authapp/templates/registration/register.html
```
```html
{% extends 'base.html' %}

{% block content %}
<div class="row justify-content-center my-2">
  <div class="col-lg-6">
    <h3>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
    <form method="post" class="mt-2" enctype="multipart/form-data">
      {% csrf_token %}
      <div id="div_id_username" class="form-group"> <label for="id_username"
          class=" requiredField">
          Username<span class="asteriskField">*</span> </label>
        <div class=""> <input type="text" name="username" maxlength="150"
            class="textinput textInput form-control" required=""
            id="id_username"> <small id="hint_id_username"
            class="form-text text-muted">Required. 150 characters or fewer.
            Letters, digits and @/./+/-/_ only.</small> </div>
      </div>
      <div id="div_id_password1" class="form-group"> <label for="id_password1"
          class=" requiredField">
          Password<span class="asteriskField">*</span> </label>
        <div class=""> <input type="password" name="password1"
            autocomplete="new-password" class="textinput textInput form-control"
            required="" id="id_password1"> <small id="hint_id_password1"
            class="form-text text-muted">
            <ul>
              <li>Your password can‚Äôt be too similar to your other personal
                information.</li>
              <li>Your password must contain at least 8 characters.</li>
              <li>Your password can‚Äôt be a commonly used password.</li>
              <li>Your password can‚Äôt be entirely numeric.</li>
            </ul>
          </small> </div>
      </div>
      <div id="div_id_password2" class="form-group"> <label for="id_password2"
          class=" requiredField">
          Password confirmation<span class="asteriskField">*</span> </label>
        <div class=""> <input type="password" name="password2"
            autocomplete="new-password" class="textinput textInput form-control"
            required="" id="id_password2"> <small id="hint_id_password2"
            class="form-text text-muted">Enter the same password as before, for
            verification.</small> </div>
      </div>
      <div id="div_id_first_name" class="form-group"> <label for="id_first_name"
          class="">
          First name
        </label>
        <div class=""> <input type="text" name="first_name" maxlength="150"
            class="textinput textInput form-control" id="id_first_name"> </div>
      </div>
      <div id="div_id_last_name" class="form-group"> <label for="id_last_name"
          class="">
          Last name
        </label>
        <div class=""> <input type="text" name="last_name" maxlength="150"
            class="textinput textInput form-control" id="id_last_name"> </div>
      </div>
      <div id="div_id_age" class="form-group"> <label for="id_age" class="">
          Age
        </label>
        <div class=""> <input type="number" name="age" min="0"
            class="numberinput form-control" id="id_age"> </div>
      </div>
      <div id="div_id_avatar" class="form-group"> <label for="id_avatar"
          class="">
          Avatar
        </label>
        <div class=""> <input type="file" name="avatar" accept="image/*"
            class="clearablefileinput form-control-file" id="id_avatar"> </div>
      </div>
      <div id="div_id_email" class="form-group"> <label for="id_email"
          class=" requiredField">
          Email address<span class="asteriskField">*</span> </label>
        <div class=""> <input type="text" name="email" maxlength="256"
            class="textinput textInput form-control" required="" id="id_email">
        </div>
      </div>

      <button type="submit"
        class="btn btn-primary btn-block">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
    </form>
  </div>
</div>

{% endblock content %}
```
* authapp/views.py –¥–æ–±–∞–≤–ª—è–µ–º –≤–Ω–∏–∑ —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥
```python
from authapp import models
from django.http.response import HttpResponseRedirect
from django.urls import reverse_lazy

class RegisterView(TemplateView):
    template_name = "registration/register.html"

    def post(self, request, *args, **kwargs):

        # –∫–æ–¥ –æ–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è –≤ try/except, —á—Ç–æ–±—ã –∫–æ–¥ –æ—Ç—Ä–∞–±–æ—Ç–∞–ª –¥–æ –∫–æ–Ω—Ü–∞, –∏ –µ—Å–ª–∏ —á—Ç–æ —Å–æ–æ–±—â–∏–ª –æ–± –æ—à–∏–±–∫–µ
        # —á–µ—Ä–µ–∑ —Ñ—Ä–µ–π–º–æ–≤–æ—Ä–∫ —Å–æ–æ–±—â–µ–Ω–∏–π
        try:
            if all(
                (
                    request.POST.get("username"),
                    request.POST.get("email"),
                    request.POST.get("password1"),
                    request.POST.get("password1") == request.POST.get("password2"),
                )
            ):
                #–µ—Å–ª–∏ –≤—Å–µ –æ–∫, —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                new_user = models.CustomUser.objects.create(
                    username=request.POST.get("username"),
                    first_name=request.POST.get("first_name"),
                    last_name=request.POST.get("last_name"),
                    age=request.POST.get("age") if request.POST.get("age") else 0,
                    avatar=request.FILES.get("avatar"),
                    email=request.POST.get("email"),
                )
                #–ø–∞—Ä–æ–ª–∏ –∑–∞–±–∏—Ä–∞—é—Ç—Å—è –≤–≤–∏–¥–µ —Ö—ç—à—Å—É–º–º—ã SHA256
                new_user.set_password(request.POST.get("password1"))
                new_user.save()
                # _ - —Ñ–µ–π–º–≤–æ—Ä–∫ —Å–æ–æ–±—â–µ–Ω–∏–π, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ –∫–∞–∫–æ–π —è–∑—ã–∫ –≤–∫–ª—é—á–µ–Ω
                messages.add_message(request, messages.INFO, _("Registration success!"))
                # reverse_lazy - —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –ø—É—Å—Ç—å –¥–ª—è –ø–µ—Ä–µ–Ω–µ–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å—Ä–∞–∑—É –∏–∑ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º–µ–Ω
                return HttpResponseRedirect(reverse_lazy("authapp:login"))
        except Exception as exp:
            messages.add_message(
                request,
                messages.WARNING,
                mark_safe(f"Something goes worng:<br>{exp}"),
            )
            return HttpResponseRedirect(reverse_lazy("authapp:register"))
```
* –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è
* authapp/views.py –¥–æ–±–∞–≤–ª—è–µ–º –≤ –∫–æ–Ω–µ—Ü
* LoginRequiredMixin - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–æ—à–µ–ª –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞ —Å–∞–π—Ç
* login_url - —É–∫–∞–∂–µ—Ç, –∫—É–¥–∞ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —á—Ç–æ–±—ã –æ–Ω –º–æ–≥ –≤–æ–π—Ç–∏ –Ω–∞ —Å–∞–π—Ç
```python
from django.contrib.auth.mixins import LoginRequiredMixin


class RegisterView(TemplateView):
    template_name = "registration/register.html"

    def post(self, request, *args, **kwargs):
        try:
            if all(
                (
                    request.POST.get("username"),
                    request.POST.get("email"),
                    request.POST.get("password1"),
                    request.POST.get("password1") == request.POST.get("password2"),
                )
            ):
                new_user = models.CustomUser.objects.create(
                    username=request.POST.get("username"),
                    first_name=request.POST.get("first_name"),
                    last_name=request.POST.get("last_name"),
                    age=request.POST.get("age") if request.POST.get("age") else 0,
                    avatar=request.FILES.get("avatar"),
                    email=request.POST.get("email"),
                )
                new_user.set_password(request.POST.get("password1"))
                new_user.save()
                messages.add_message(request, messages.INFO, _("Registration success!"))
                return HttpResponseRedirect(reverse_lazy("authapp:login"))
        except Exception as exp:
            messages.add_message(
                request,
                messages.WARNING,
                mark_safe(f"Something goes worng:<br>{exp}"),
            )
            return HttpResponseRedirect(reverse_lazy("authapp:register"))
```
* touch authapp/templates/registration/profile_edit.html
```html
{% extends 'base.html' %}

{% block content %}
<div class="row justify-content-center my-2">
  <div class="col-lg-6">
    <h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è</h3>

    <div class="row justify-content-center">
      <div class="col-sm-7 col-md-5 col-lg-4">
        {% if user.avatar %}
        <img src="{{ user.avatar.url }}" alt="" width="100%">
        {% else %}
        <img src="{{ MEDIA_URL }}avatar_default.svg" alt="" width="100%">
        {% endif %}
      </div>
    </div>

    <form method="post" class="mt-2" enctype="multipart/form-data">
      {% csrf_token %}
      <div id="div_id_username" class="form-group"> <label for="id_username"
          class=" requiredField">
          Username<span class="asteriskField">*</span> </label>
        <div class=""> <input type="text" name="username" maxlength="150"
            class="textinput textInput form-control" required id="id_username"
            value="{{ user.username }}"> <small id="hint_id_username"
            class="form-text text-muted">Required. 150 characters or fewer.
            Letters, digits and @/./+/-/_ only.</small> </div>
      </div>
      <div id="div_id_first_name" class="form-group"> <label for="id_first_name"
          class="">
          First name
        </label>
        <div class=""> <input type="text" name="first_name" maxlength="150"
            class="textinput textInput form-control" id="id_first_name"
            value="{{ user.first_name }}"> </div>
      </div>
      <div id="div_id_last_name" class="form-group"> <label for="id_last_name"
          class="">
          Last name
        </label>
        <div class=""> <input type="text" name="last_name" maxlength="150"
            class="textinput textInput form-control" id="id_last_name"
            value="{{ user.last_name }}"> </div>
      </div>
      <div id="div_id_age" class="form-group"> <label for="id_age" class="">
          Age
        </label>
        <div class=""> <input type="number" name="age" min="0"
            class="numberinput form-control" id="id_age" value="{{ user.age }}">
        </div>
      </div>
      <div id="div_id_avatar" class="form-group"> <label for="id_avatar"
          class="">
          Avatar
        </label>
        <div class=""> <input type="file" name="avatar" accept="image/*"
            class="clearablefileinput form-control-file" id="id_avatar"> </div>
      </div>
      <div id="div_id_email" class="form-group"> <label for="id_email"
          class=" requiredField">
          Email address<span class="asteriskField">*</span> </label>
        <div class=""> <input type="text" name="email" maxlength="256"
            class="textinput textInput form-control" required="" id="id_email"
            value="{{ user.email }}">
        </div>
      </div>

      <button type=" submit"
        class="btn btn-primary btn-block">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    </form>
  </div>
</div>

{% endblock content %}
```
* 
```

```
* 
```

```
* 
```

```
* 
```

```
* 
```

```
* 
```

```
* 
```

```
* 
```

```
* 
```

```
* 
```

```
* 
```

```
* 
```

```
* 
```

```
* 
```

```
* 
```

```
* 
```

```
* 
```

```
* 
```

```
* 
```

```
* 
```

```
* 
```

```
* 
```

```
